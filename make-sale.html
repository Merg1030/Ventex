<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roof Connect - Sales Module</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
 * {margin:0; padding:0; box-sizing:border-box; font-family:"Poppins", "Segoe UI", Tahoma, sans-serif;}
  body {background:#f8fafc; color:#1e293b; min-height:100vh; padding: 20px;}
  
  /* Header */
  .header {background:#fff; display:flex; align-items:center; justify-content:space-between; padding:15px 25px; box-shadow:0 4px 12px rgba(0,0,0,0.05); border-radius: 12px; margin-bottom: 25px;}
  .header h1 {color:#1e293b; font-size:1.5rem; font-weight:600; display: flex; align-items: center;}
  .header h1 i {margin-right: 12px; color: #38bdf8;}
  .user-info {display:flex; align-items:center;}
  .user-info img {width:40px; height:40px; border-radius:50%; margin-right:10px; object-fit:cover;}
  .logout-btn {background:#f1f5f9; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; color:#64748b; font-weight:500; display:flex; align-items:center; transition:0.2s;}
  .logout-btn i {margin-right:8px;}
  .logout-btn:hover {background:#e2e8f0; color:#1e293b;}
  
  .container {background:#f1f5f9; border-radius: 16px; padding: 25px;}
  .section {background:#fff; border-radius:16px; padding:25px; margin-bottom:25px; box-shadow:0 4px 20px rgba(0,0,0,0.06);}
  .section h2 {margin-bottom:20px; color:#1e293b; font-weight:600; display:flex; align-items:center;}
  .section h2 i {margin-right:12px; color:#38bdf8;}
  
  /* Buttons */
  .btn {padding:12px 20px; border-radius:10px; cursor:pointer; font-weight:500; display:inline-flex; align-items:center; transition:all 0.2s; border:none;}
  .btn i {margin-right:8px;}
  .btn-primary {background:#38bdf8; color:white;}
  .btn-primary:hover {background:#0ea5e9;}
  .btn-success {background:#22c55e; color:white;}
  .btn-success:hover {background:#16a34a;}
  .btn-danger {background:#ef4444; color:white;}
  .btn-danger:hover {background:#dc2626;}
  
  /* Tables */
  table {width:100%; border-collapse:separate; border-spacing:0; margin-bottom:20px; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.05);}
  th, td {padding:16px; text-align:left; border-bottom:1px solid#e2e8f0;}
  th {background:#f8fafc; color:#64748b; font-weight:600; font-size:0.9rem;}
  tr:last-child td {border-bottom:none;}
  tr:hover {background:#f8fafc;}
  
  /* Form */
  .form-group {margin-bottom:20px;}
  .form-group label {display:block; margin-bottom:8px; color:#374151; font-weight:500;}
  .form-control {width:100%; padding:12px 16px; border:1px solid#d1d5db; border-radius:10px; font-size:1rem; transition:border-color 0.2s;}
  .form-control:focus {outline:none; border-color:#38bdf8; box-shadow:0 0 0 3px rgba(56, 189, 248, 0.2);}
  .form-row {display:flex; gap:15px;}
  .form-row .form-group {flex:1;}
  
  /* Cart */
  .cart {background:#f8fafc; border-radius:12px; padding:20px; margin-top:20px;}
  .cart-item {display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid#e2e8f0;}
  .cart-item:last-child {border-bottom:none;}
  .cart-total {margin-top:15px; padding-top:15px; border-top:2px solid#e2e8f0; font-weight:600; font-size:1.1rem;}
  
  /* Modal */
  .modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center; overflow:auto;}
  .modal-content {background:#fff; width:90%; max-width:800px; border-radius:16px; padding:25px; box-shadow:0 10px 40px rgba(0,0,0,0.1); max-height:90vh; overflow-y:auto;}
  .modal-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
  .modal-header h2 {margin:0;}
  .close-modal {background:none; border:none; font-size:1.5rem; cursor:pointer; color:#64748b;}
  
  /* Invoice */
  .invoice {padding:30px; background:#fff; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.06);}
  .invoice-header {display:flex; justify-content:space-between; margin-bottom:30px;}
  .invoice-details {display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:30px;}
  .invoice-table {width:100%; border-collapse:collapse; margin:20px 0;}
  .invoice-table th {background:#f1f5f9; padding:12px; text-align:left;}
  .invoice-table td {padding:12px; border-bottom:1px solid#e2e8f0;}
  .invoice-totals {margin-top:20px; text-align:right;}
  .invoice-totals div {margin-bottom:10px;}
  .invoice-total {font-size:1.2rem; font-weight:700; border-top:2px solid#1e293b; padding-top:10px;}
  
  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-in {animation: fadeIn 0.3s ease forwards;}
  
  /* Loading spinner */
  .spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-left: 4px solid #38bdf8;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 20px auto;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  .disabled {
    opacity: 0.6;
    pointer-events: none;
  }
</style>
</head>
<body>

<div class="header">
  <h1><i class="fas fa-cash-register"></i> Roof Connect - Sales Module</h1>
  <div class="user-info">
    <img src="https://ui-avatars.com/api/?name=Sales+Person&background=38bdf8&color=fff" alt="User">
    <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
  </div>
</div>

<div class="container">
  <!-- Make Sale -->
  <div id="make-sale" class="section">
    <h2><i class="fas fa-cash-register"></i> Create Sale / Quotation</h2>
    
    <div class="form-row">
      <div class="form-group" style="flex:2;">
        <label for="customer-select">Customer</label>
        <select id="customer-select" class="form-control" onchange="populateCustomerDetails()">
          <option value="cash">Cash Sale</option>
        </select>
      </div>
      <div class="form-group" style="flex:1;">
        <label for="invoice-number">Invoice Number</label>
        <input type="text" id="invoice-number" class="form-control" value="INV-001" readonly>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label for="customer-name">Customer Name</label>
        <input type="text" id="customer-name" class="form-control" placeholder="Enter customer name" readonly>
      </div>
      <div class="form-group">
        <label for="customer-tpin">Customer TPIN</label>
        <input type="text" id="customer-tpin" class="form-control" placeholder="Enter TPIN" readonly>
      </div>
      <div class="form-group">
        <label for="customer-address">Customer Address</label>
        <input type="text" id="customer-address" class="form-control" placeholder="Enter address" readonly>
      </div>
    </div>
    
    <h3>Add Items</h3>
    <div class="spinner" id="inventory-spinner" style="display: none;"></div>
    <table id="sales-table">
      <thead>
        <tr>
          <th>Item Name</th>
          <th>Available Stock</th>
          <th>Unit Price (ZMW)</th>
          <th>Quantity</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    
    <div class="cart">
      <h3>Cart Items</h3>
      <div id="cart-items"></div>
      <div class="cart-total">Total: ZMW <span id="cart-total">0.00</span></div>
    </div>
    
    <div style="margin-top: 20px; text-align: right;">
      <button id="btn-quotation" class="btn btn-primary" onclick="createQuotation()"><i class="fas fa-file-alt"></i> Create Quotation</button>
      <button id="btn-sale" class="btn btn-success" onclick="processSale()"><i class="fas fa-check-circle"></i> Process Sale</button>
    </div>
  </div>
</div>

<!-- Invoice Modal -->
<div class="modal" id="invoice-modal">
  <div class="modal-content fade-in">
    <div class="modal-header">
      <h2><i class="fas fa-file-invoice"></i> Invoice</h2>
      <button class="close-modal" onclick="closeInvoice()">&times;</button>
    </div>
    <div id="invoice-content"></div>
    <div style="margin-top: 20px; text-align: right;">
      <button class="btn" onclick="closeInvoice()" style="margin-right: 10px;">Close</button>
      <button class="btn btn-primary" onclick="printInvoice()"><i class="fas fa-print"></i> Print</button>
      <button class="btn btn-success" onclick="downloadInvoice()"><i class="fas fa-download"></i> Download PDF</button>
    </div>
  </div>
</div>

<!-- Firebase SDKs -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
  import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, onSnapshot, query, where, orderBy } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
  const firebaseConfig = {
    apiKey: "AIzaSyBe80piQUIDk-ZQkG-g8qQt5GSyG8OMEpc",
    authDomain: "ventex-8a99b.firebaseapp.com",
    projectId: "ventex-8a99b",
    storageBucket: "ventex-8a99b.firebasestorage.app",
    messagingSenderId: "221902916669",
    appId: "1:221902916669:web:3218ca7a4256ef86cbae54",
    measurementId: "G-JJHSK9Q9XT"
  };
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getFirestore(app);
  window.db = db;
  window.getDocs = getDocs;
  window.addDoc = addDoc;
  window.collection = collection;
  window.updateDoc = updateDoc;
  window.doc = doc;
  window.onSnapshot = onSnapshot;
  window.query = query;
  window.where = where;
  window.orderBy = orderBy;
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Global variables
let inventory = [];
let cart = [];
let invoiceCount = 1;
let user = { name: "Sales Person", id: "sales001" };
let customers = [];

// DOM Elements
const salesBody = document.querySelector("#sales-table tbody");
const invoiceModal = document.getElementById("invoice-modal");
const invoiceContent = document.getElementById("invoice-content");
const cartItems = document.getElementById("cart-items");
const cartTotal = document.getElementById("cart-total");
const customerSelect = document.getElementById("customer-select");

// Company details for invoice
const companyDetails = {
  name: "ROOF CONNECT LTD",
  location: "Plot No 111828, Kasuba Road, Light Industrial Area, Lusaka",
  cell: "+260 953561193, +260 961696422, +260 964752363",
  email: "Roofconnectzambia2017@gmail.com",
  tpin: "1005679427",
  bank: {
    acc: "0335827534010",
    branch: "Industrial Branch",
    branchCode: "200033",
    swift: "FMBZZMLK",
    bankName: "Access Bank"
  }
};

// Initialize the application
async function initializeApp() {
  try {
    await loadInventory();
    await loadCustomers();
    setupRealTimeListeners();
    generateInvoiceNumber();
    renderSales();
    populateCustomerDropdown();
    populateCustomerDetails();
  } catch (error) {
    console.error("Error initializing app:", error);
    alert("Failed to initialize application. Please check your connection.");
  }
}

// Load inventory from Firestore
async function loadInventory() {
  try {
    document.getElementById('inventory-spinner').style.display = 'block';
    const querySnapshot = await getDocs(collection(db, "inventory"));
    inventory = [];
    querySnapshot.forEach((doc) => {
      inventory.push({ id: doc.id, ...doc.data() });
    });
    document.getElementById('inventory-spinner').style.display = 'none';
  } catch (error) {
    console.error("Error loading inventory:", error);
    document.getElementById('inventory-spinner').style.display = 'none';
    alert("Failed to load inventory.");
  }
}

// Load customers from Firestore
async function loadCustomers() {
  try {
    const querySnapshot = await getDocs(collection(db, "customers"));
    customers = [];
    querySnapshot.forEach((doc) => {
      customers.push({ id: doc.id, ...doc.data() });
    });
  } catch (error) {
    console.error("Error loading customers:", error);
    alert("Failed to load customers.");
  }
}

// Set up real-time listeners
function setupRealTimeListeners() {
  onSnapshot(collection(db, "inventory"), (snapshot) => {
    inventory = [];
    snapshot.forEach((doc) => {
      inventory.push({ id: doc.id, ...doc.data() });
    });
    renderSales();
  });
  
  // Customers listener
  onSnapshot(collection(db, "customers"), (snapshot) => {
    customers = [];
    snapshot.forEach((doc) => {
      customers.push({ id: doc.id, ...doc.data() });
    });
    populateCustomerDropdown();
  });
}

// Generate invoice number based on count of orders
async function generateInvoiceNumber() {
  try {
    const q = query(collection(db, "orders"), orderBy("date", "desc"));
    const querySnapshot = await getDocs(q);
    invoiceCount = querySnapshot.size + 1;
    document.getElementById("invoice-number").value = `INV-${invoiceCount.toString().padStart(3, '0')}`;
  } catch (error) {
    console.error("Error generating invoice number:", error);
    document.getElementById("invoice-number").value = `INV-${invoiceCount.toString().padStart(3, '0')}`;
  }
}

// Render Sales Table
function renderSales(){
  salesBody.innerHTML="";
  inventory.forEach((item,index)=>{
    const row=document.createElement("tr");
    row.innerHTML=`
      <td>${item.name}</td>
      <td>${item.stock}</td>
      <td>${item.price.toFixed(2)}</td>
      <td>
        <input type="number" class="form-control" min="1" value="1" id="qty-${item.id}" style="width: 80px;">
      </td>
      <td>
        <button class="btn btn-primary" onclick="addToCart('${item.id}')" id="add-to-cart-${item.id}"><i class="fas fa-cart-plus"></i> Add to Cart</button>
      </td>
    `;
    salesBody.appendChild(row);
  });
}

// Add item to cart (allow even if not in stock)
function addToCart(itemId) {
  const item = inventory.find(i => i.id === itemId);
  const quantity = parseInt(document.getElementById(`qty-${itemId}`).value);
  const btn = document.getElementById(`add-to-cart-${itemId}`);
  btn.classList.add('disabled');
  setTimeout(() => btn.classList.remove('disabled'), 900); // Prevent multiple clicks

  if (quantity <= 0) {
    alert("Invalid quantity!");
    return;
  }
  const existingItem = cart.find(i => i.id === itemId);
  if (existingItem) {
    existingItem.quantity += quantity;
  } else {
    cart.push({
      id: item.id,
      name: item.name,
      price: item.price,
      quantity: quantity
    });
  }
  updateCart();
}

// Update cart display
function updateCart() {
  cartItems.innerHTML = "";
  let total = 0;
  cart.forEach((item, index) => {
    const itemTotal = item.price * item.quantity;
    total += itemTotal;
    const cartItem = document.createElement("div");
    cartItem.className = "cart-item";
    cartItem.innerHTML = `
      <div>${item.name} x ${item.quantity}</div>
      <div>ZMW ${itemTotal.toFixed(2)} <button class="btn btn-danger" style="padding: 2px 8px; margin-left: 10px;" onclick="removeFromCart(${index})"><i class="fas fa-trash"></i></button></div>
    `;
    cartItems.appendChild(cartItem);
  });
  cartTotal.textContent = total.toFixed(2);
}

// Remove item from cart
function removeFromCart(index) {
  cart.splice(index, 1);
  updateCart();
}

// Customer dropdown
function populateCustomerDropdown() {
  customerSelect.innerHTML = `<option value="cash">Cash Sale</option>`;
  customers.forEach(customer => {
    customerSelect.innerHTML += `<option value="${customer.id}">${customer.name}</option>`;
  });
}

// Populate customer details
function populateCustomerDetails() {
  const selectedId = customerSelect.value;
  if (selectedId === "cash") {
    document.getElementById("customer-name").value = "Cash Sale";
    document.getElementById("customer-tpin").value = "";
    document.getElementById("customer-address").value = "";
  } else {
    const customer = customers.find(c => c.id === selectedId);
    document.getElementById("customer-name").value = customer?.name || "";
    document.getElementById("customer-tpin").value = customer?.tpin || "";
    document.getElementById("customer-address").value = customer?.address || "";
  }
}

// Create Quotation
function createQuotation() {
  const btn = document.getElementById("btn-quotation");
  btn.classList.add('disabled');
  setTimeout(() => btn.classList.remove('disabled'), 1500);

  if (cart.length === 0) {
    alert("Please add items to cart first!");
    return;
  }
  const customerName = document.getElementById("customer-name").value;
  const customerTpin = document.getElementById("customer-tpin").value;
  if (!customerName) {
    alert("Please select a customer!");
    return;
  }
  // Check for out-of-stock items
  const outOfStockItems = cart.filter(item => {
    const inventoryItem = inventory.find(i => i.id === item.id);
    return inventoryItem.stock < item.quantity;
  });
  if (outOfStockItems.length > 0) {
    alert(
      "Please note: The following items are out of stock or insufficient stock and are being quoted:\n" +
      outOfStockItems.map(i => `${i.name} (In stock: ${inventory.find(inv => inv.id === i.id).stock}, Quoted: ${i.quantity})`).join("\n")
    );
  }
  generateInvoice("quotation");
}

// Process Sale (do not allow sale if not enough stock)
async function processSale() {
  const btn = document.getElementById("btn-sale");
  btn.classList.add('disabled');
  setTimeout(() => btn.classList.remove('disabled'), 1500);

  if (cart.length === 0) {
    alert("Please add items to cart first!");
    return;
  }
  const customerName = document.getElementById("customer-name").value;
  const customerTpin = document.getElementById("customer-tpin").value;
  if (!customerName) {
    alert("Please select a customer!");
    return;
  }
  for (const item of cart) {
    const inventoryItem = inventory.find(i => i.id === item.id);
    if (inventoryItem.stock < item.quantity) {
      alert(`Not enough stock for ${item.name}! Only ${inventoryItem.stock} available.`);
      return;
    }
  }
  const invoiceNumber = document.getElementById("invoice-number").value;
  const order = {
    orderNumber: `ORD-${Date.now()}`,
    invoiceNumber,
    customerName,
    customerTpin,
    customerAddress: document.getElementById("customer-address").value,
    items: [...cart],
    status: "pending",
    date: new Date().toISOString(),
    salespersonId: user.id,
    salespersonName: user.name,
    total: calculateTotal()
  };
  try {
    await addDoc(collection(db, "orders"), order);
    for (const item of cart) {
      const inventoryItem = inventory.find(i => i.id === item.id);
      const newStock = inventoryItem.stock - item.quantity;
      await updateDoc(doc(db, "inventory", item.id), { stock: newStock });
    }
    generateInvoice("invoice");
    cart = [];
    updateCart();
    document.getElementById("customer-name").value = "";
    document.getElementById("customer-tpin").value = "";
    document.getElementById("customer-address").value = "";
    customerSelect.value = "cash";
    invoiceCount++;
    generateInvoiceNumber();
  } catch (error) {
    console.error("Error processing sale:", error);
    alert("Failed to process sale. Please try again.");
  }
}

// Calculate total including VAT
function calculateTotal() {
  let subtotal = 0;
  cart.forEach(item => {
    subtotal += item.price * item.quantity;
  });
  const vatRate = 0.16;
  const vat = subtotal * vatRate;
  return subtotal + vat;
}

// Generate Invoice
function generateInvoice(type) {
  const customerName = document.getElementById("customer-name").value;
  const customerTpin = document.getElementById("customer-tpin").value;
  const customerAddress = document.getElementById("customer-address").value;
  const invoiceNumber = document.getElementById("invoice-number").value;
  let subtotal = 0;
  cart.forEach(item => {
    subtotal += item.price * item.quantity;
  });
  const vatRate = 0.16;
  const vat = subtotal * vatRate;
  const total = subtotal + vat;
  const date = new Date().toLocaleDateString();

  // Top right company info
  const companyBlockTopRight = `
    <div style="text-align: right; font-size:1.05rem; margin-bottom:6px;">
      <strong style="font-size:1.25rem; color:#1e293b;">${companyDetails.name}</strong><br>
      <span>${companyDetails.location}</span><br>
      <span>TPIN: ${companyDetails.tpin}</span><br>
      <span>Cell: ${companyDetails.cell}</span><br>
      <span>Email: ${companyDetails.email}</span>
    </div>
  `;
  // Bank details block bottom left
  const bankBlockBottomLeft = `
    <div style="font-size:0.98rem; margin-top:30px; text-align:left;">
      <strong>Banking Details</strong><br>
      Acc No: ${companyDetails.bank.acc}<br>
      Branch: ${companyDetails.bank.branch}<br>
      Branch Code: ${companyDetails.bank.branchCode}<br>
      SWIFT Code: ${companyDetails.bank.swift}<br>
      Bank Name: ${companyDetails.bank.bankName}
    </div>
  `;

  // Top left TAX INVOICE only for invoice, never for quotation
  const topLeftLabel = type === 'invoice'
    ? `<div style="font-size:2rem; font-weight:700; color:#0ea5e9;">TAX INVOICE</div>` : "";

  // Top right label for QUOTATION only
  const topRightLabel = type === 'quotation'
    ? `<div style="font-size:2rem; font-weight:700; color:#38bdf8; margin-left:10px;">QUOTATION</div>` : "";

  invoiceContent.innerHTML = `
    <div class="invoice">
      <div style="display:flex; justify-content:space-between; align-items:flex-start;">
        ${topLeftLabel}
        ${companyBlockTopRight}
      </div>
      <div style="display:flex; justify-content:space-between; align-items:center; margin-top:12px;">
        <div>
          <span style="font-size:1.08rem; font-weight:600;">Invoice No: </span>${invoiceNumber}<br>
          <span style="font-size:1.08rem; font-weight:600;">Date: </span>${date}
        </div>
        ${topRightLabel}
      </div>
      <div class="invoice-details" style="margin-top:20px;">
        <div>
          <h3>Bill To:</h3>
          <p>${customerName ? customerName : "Cash Sale"}</p>
          ${customerTpin ? `<p>TPIN: ${customerTpin}</p>` : ""}
          <p>${customerAddress ? customerAddress : ""}</p>
        </div>
        <div style="text-align: right;">
          <h3>Status:</h3>
          <p>${type === 'quotation' ? 'Quotation' : 'Pending Approval'}</p>
        </div>
      </div>
      <table class="invoice-table">
        <thead>
          <tr>
            <th>Item</th>
            <th>Quantity</th>
            <th>Unit Price (ZMW)</th>
            <th>Total (ZMW)</th>
          </tr>
        </thead>
        <tbody>
          ${cart.map(item => `
            <tr>
              <td>${item.name}</td>
              <td>${item.quantity}</td>
              <td>${item.price.toFixed(2)}</td>
              <td>${(item.price * item.quantity).toFixed(2)}</td>
            </tr>
          `).join('')}
        </tbody>
      </table>
      <div class="invoice-totals">
        <div>Subtotal: ZMW ${subtotal.toFixed(2)}</div>
        ${type === 'invoice' ? `<div>VAT (16%): ZMW ${vat.toFixed(2)}</div>` : ""}
        <div class="invoice-total">Total: ZMW ${type === 'invoice' ? total.toFixed(2) : subtotal.toFixed(2)}</div>
      </div>
      ${type === 'quotation' ? `
        <div style="margin-top: 30px; text-align: center;">
          <p>This is a quotation. Prices are valid for 30 days.</p>
        </div>
      ` : `
        <div style="margin-top: 30px;">
          <p>Thank you for your business! This order has been sent to the warehouse for approval.</p>
        </div>
      `}
      ${bankBlockBottomLeft}
    </div>
  `;
  invoiceModal.style.display = "flex";
}

// Print Invoice
function printInvoice(){
  window.print();
}

// Download Invoice as PDF
function downloadInvoice(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const invoiceHtml = invoiceContent.querySelector('.invoice');
  doc.html(invoiceHtml, {
    callback: function(doc) {
      doc.save('invoice.pdf');
    },
    x: 10,
    y: 10
  });
}

// Close Invoice
function closeInvoice(){
  invoiceModal.style.display="none";
}

// Logout
function logout(){
  alert("Logging out...");
}

document.addEventListener('DOMContentLoaded', initializeApp);
</script>
</body>
</html>